(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5136:function(e,t,s){Promise.resolve().then(s.bind(s,1011))},6588:function(e,t,s){"use strict";s.d(t,{Z:function(){return i},e:function(){return o}});var l=s(7437),a=s(2265),r=s(3113);let n=[".txt",".md",".html",".css",".js",".json",".pdf",".jpg",".jpeg",".png",".gif",".svg",".webp",".bmp"];function o(e){let t=e.slice(e.lastIndexOf(".")).toLowerCase();return n.includes(t)}function i(e){let{filePath:t,fileName:s,onClose:n}=e,[o,i]=(0,a.useState)(null),[c,d]=(0,a.useState)(!0),[x,h]=(0,a.useState)(null),[u,p]=(0,a.useState)(""),m=s?s.slice(s.lastIndexOf(".")).toLowerCase():"";return((0,a.useEffect)(()=>{if(t){if(d(!0),h(null),".md"===m||".txt"===m){p("text"),fetch("".concat(r.S,"/api/file-manager/view?path=").concat(encodeURIComponent(t))).then(e=>{if(!e.ok)throw Error("Failed to load");return e.text()}).then(i).catch(h).finally(()=>d(!1));return}if([".jpg",".jpeg",".png",".gif",".svg",".webp",".bmp"].includes(m)){p("image"),i("".concat(r.S,"/api/file-manager/view?path=").concat(encodeURIComponent(t))),d(!1);return}if(".pdf"===m){p("pdf"),i("".concat(r.S,"/api/file-manager/view?path=").concat(encodeURIComponent(t))),d(!1);return}p("text"),fetch("".concat(r.S,"/api/file-manager/view?path=").concat(encodeURIComponent(t))).then(e=>{if(!e.ok)throw Error("Failed to load");return e.text()}).then(i).catch(h).finally(()=>d(!1))}},[t,m]),t)?(0,l.jsx)("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm",onClick:n,children:(0,l.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] flex flex-col border border-slate-200",onClick:e=>e.stopPropagation(),children:[(0,l.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-slate-200",children:[(0,l.jsx)("h3",{className:"font-semibold text-slate-800 truncate",children:s}),(0,l.jsx)("button",{onClick:n,className:"p-2 text-slate-400 hover:text-slate-600 rounded-lg hover:bg-slate-100",children:(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,l.jsxs)("div",{className:"flex-1 overflow-auto p-4 min-h-[200px] scrollbar-thin",children:[c&&(0,l.jsx)("p",{className:"text-slate-500",children:"Loading..."}),x&&(0,l.jsx)("p",{className:"text-red-600",children:x}),!c&&!x&&"image"===u&&o&&(0,l.jsx)("img",{src:o,alt:s,className:"max-w-full h-auto rounded-lg shadow-inner"}),!c&&!x&&"pdf"===u&&o&&(0,l.jsx)("embed",{src:o,type:"application/pdf",className:"w-full min-h-[70vh] rounded-lg border border-slate-200",title:s}),!c&&!x&&"text"===u&&null!=o&&(0,l.jsx)("pre",{className:"text-sm text-slate-700 bg-slate-50 p-4 rounded-lg overflow-x-auto whitespace-pre-wrap font-mono",children:o})]})]})}):null}},3113:function(e,t,s){"use strict";s.d(t,{S:function(){return l}});let l=s(257).env.NEXT_PUBLIC_API_URL||""},1011:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return w}});var l=s(7437),a=s(2265),r=s(3113);function n(e){let{type:t}=e;return"directory"===t?(0,l.jsx)("svg",{className:"w-4 h-4 text-purple-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,l.jsx)("path",{d:"M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"})}):(0,l.jsx)("svg",{className:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}function o(e){let{node:t,onDelete:s,level:r=0}=e,[i,c]=(0,a.useState)(!1),[d,x]=(0,a.useState)(!1);return(0,l.jsxs)("div",{className:"select-none",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 py-1 px-2 rounded-md transition-colors cursor-pointer ".concat(d?"bg-purple-50":""),style:{paddingLeft:"".concat(12*r+8,"px")},onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),onClick:()=>{"directory"===t.type&&c(!i)},children:[(0,l.jsxs)("div",{className:"flex-shrink-0",children:["directory"===t.type?(0,l.jsx)("span",{className:"text-slate-400 text-xs mr-1",children:i?"▼":"▶"}):(0,l.jsx)("span",{className:"w-3 inline-block"}),(0,l.jsx)(n,{type:t.type})]}),(0,l.jsx)("span",{className:"text-sm text-slate-700 truncate flex-1",children:t.name}),d&&(0,l.jsx)("button",{onClick:e=>{e.stopPropagation(),s(t.path,t.type,t.children&&t.children.length>0)},className:"text-xs text-red-500 hover:text-red-700 font-medium px-1.5 py-0.5 rounded hover:bg-red-50",title:"Delete",children:"Del"})]}),i&&t.children&&(0,l.jsx)("div",{children:t.children.map(e=>(0,l.jsx)(o,{node:e,onDelete:s,level:r+1},e.path))})]})}function i(e){let{tree:t,onDelete:s,onRefresh:a}=e;return t&&0!==t.length?(0,l.jsxs)("div",{className:"glass-card rounded-2xl overflow-hidden flex flex-col h-full shadow-sm",children:[(0,l.jsxs)("div",{className:"px-4 py-3 flex justify-between items-center border-b border-slate-100 bg-white/30",children:[(0,l.jsx)("h3",{className:"font-semibold text-slate-700 text-xs uppercase tracking-wider",children:"Workspace Explorer"}),(0,l.jsx)("button",{onClick:a,className:"text-slate-400 hover:text-purple-600 transition-colors p-1 rounded hover:bg-white/50",title:"Refresh",children:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),(0,l.jsx)("div",{className:"p-3 overflow-y-auto flex-1 scrollbar-thin scrollbar-thumb-slate-200",children:t.map(e=>(0,l.jsx)(o,{node:e,onDelete:s},e.path))})]}):(0,l.jsxs)("div",{className:"glass-card rounded-2xl h-full flex flex-col items-center justify-center text-slate-400 text-sm p-8",children:[(0,l.jsx)("svg",{className:"w-12 h-12 mb-3 opacity-20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"})}),"Workspace is empty"]})}function c(e){let{targets:t,onConfirm:s,onCancel:a}=e;if(!t||0===t.length)return null;let r=t.length>1,n=t.some(e=>{var t;return"directory"===e.type&&(null!==(t=e.childrenCount)&&void 0!==t?t:0)>0});return(0,l.jsx)("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-slate-900/40 backdrop-blur-sm",children:(0,l.jsx)("div",{className:"bg-white rounded-2xl shadow-2xl p-6 max-w-md w-full border border-slate-100",onClick:e=>e.stopPropagation(),children:(0,l.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-red-100 text-red-500 rounded-full flex items-center justify-center mb-4",children:(0,l.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),(0,l.jsx)("h3",{className:"text-lg font-bold text-slate-800 mb-2",children:r?"Delete ".concat(t.length," items?"):"Delete this item?"}),(0,l.jsx)("p",{className:"text-sm text-slate-500 mb-4",children:n?"Some folders contain files. They will be removed permanently.":"This action cannot be undone."}),t.length<=5?(0,l.jsx)("ul",{className:"text-left text-sm text-slate-600 mb-6 w-full bg-slate-50 rounded-lg p-3 max-h-32 overflow-y-auto scrollbar-thin",children:t.map(e=>(0,l.jsx)("li",{className:"truncate font-mono",children:e.name},e.path))}):(0,l.jsxs)("p",{className:"text-sm text-slate-500 mb-6",children:[t.length," items selected"]}),(0,l.jsxs)("div",{className:"flex gap-3 w-full",children:[(0,l.jsx)("button",{onClick:a,className:"flex-1 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 text-sm font-medium rounded-xl transition-colors",children:"Cancel"}),(0,l.jsx)("button",{onClick:s,className:"flex-1 px-4 py-2 bg-red-500 hover:bg-red-600 text-white text-sm font-medium rounded-xl shadow-lg shadow-red-200 transition-colors",children:"Delete"})]})]})})})}var d=s(6588);function x(e){let{collapsed:t,onToggleCollapse:s,currentPath:n,onNavigate:o,onSearchClick:i,onRefreshMeta:c,onShowError:d}=e,[x,h]=(0,a.useState)([]),[u,p]=(0,a.useState)(null),[m,f]=(0,a.useState)([]),[b,g]=(0,a.useState)(["My Files"]),[j,v]=(0,a.useState)([]),[w,y]=(0,a.useState)([]),[N,k]=(0,a.useState)(!1),[C,S]=(0,a.useState)(""),L=()=>{fetch("".concat(r.S,"/api/file-manager/meta"),{cache:"no-store"}).then(e=>e.json()).then(e=>{h(e.recents||[]);let t=e.meta||{},s=new Set,l=[];Object.entries(t).forEach(e=>{let[t,a]=e;(a.tags||[]).forEach(e=>s.add(e)),a.starred&&l.push(t)}),f(Array.from(s)),v(l),y(Object.keys(e.sharedLinks||{}))}).catch(()=>{})},M=()=>{fetch("".concat(r.S,"/api/file-manager/storage"),{cache:"no-store"}).then(e=>e.json()).then(p).catch(()=>{})},D=()=>{L(),M(),z()},z=()=>{fetch("".concat(r.S,"/api/file-manager/workspaces"),{cache:"no-store"}).then(e=>e.json()).then(e=>g(e.workspaces||["My Files"])).catch(()=>{})};(0,a.useEffect)(()=>{L(),z()},[n]),(0,a.useLayoutEffect)(()=>{c&&(c.current=D)}),(0,a.useEffect)(()=>{fetch("".concat(r.S,"/api/file-manager/storage"),{cache:"no-store"}).then(e=>e.json()).then(p).catch(()=>{})},[n]);let T=e=>"My Files"===e?!n:n===e||n.startsWith(e+"/"),O=()=>{let e=C.trim();e&&fetch("".concat(r.S,"/api/file-manager/workspaces"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e})}).then(e=>e.json()).then(t=>{if(t.error)throw Error(t.error);g(t.workspaces||b),S(""),k(!1),o(e)}).catch(e=>d?d(e.message):alert(e.message))};return t?(0,l.jsxs)("aside",{className:"w-14 shrink-0 flex flex-col items-center py-3 bg-slate-50 border-r border-slate-200 rounded-l-2xl",children:[(0,l.jsx)("button",{onClick:s,className:"p-2 rounded-lg text-slate-500 hover:bg-slate-200 hover:text-slate-700 mb-2",title:"Expand sidebar",children:(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M5 5l7 7-7 7"})})}),(0,l.jsx)("button",{onClick:()=>o(""),className:"p-2.5 rounded-xl transition-colors ".concat(n?"text-slate-500 hover:bg-slate-200":"bg-purple-100 text-purple-600"),title:"My Files",children:(0,l.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,l.jsx)("path",{d:"M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"})})}),(0,l.jsx)("div",{className:"mt-2 pt-2 border-t border-slate-200 w-8"}),(0,l.jsx)("button",{onClick:()=>x[0]&&o(x[0]),className:"p-2.5 rounded-xl text-slate-500 hover:bg-slate-200",title:"Recents",children:(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),u&&(0,l.jsx)("div",{className:"mt-auto pt-2 border-t border-slate-200 text-center",children:(0,l.jsxs)("span",{className:"text-[10px] text-slate-500 block",title:"".concat(u.used," of ").concat(u.max||"?"),children:[u.used.split(" ")[0],u.max?" / ".concat(u.max.split(" ")[0]):""]})})]}):(0,l.jsxs)("aside",{className:"w-56 shrink-0 flex flex-col bg-slate-50 border-r border-slate-200 rounded-l-2xl overflow-hidden",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between px-3 py-3 border-b border-slate-200",children:[(0,l.jsx)("h2",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:"Navigation"}),(0,l.jsx)("button",{onClick:s,className:"p-1.5 rounded-lg text-slate-400 hover:bg-slate-200 hover:text-slate-600",title:"Collapse sidebar",children:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7M18 19l-7-7 7-7"})})})]}),(0,l.jsxs)("nav",{className:"flex-1 overflow-y-auto py-3 px-2 scrollbar-thin",children:[(0,l.jsx)("div",{className:"px-3 py-1",children:(0,l.jsx)("span",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:"Workspaces"})}),b.map(e=>(0,l.jsxs)("button",{onClick:()=>o("My Files"===e?"":e),className:"w-full flex items-center gap-3 px-3 py-2 text-left text-sm rounded-xl transition-colors ".concat(T(e)?"bg-purple-100 text-purple-700 font-medium":"text-slate-700 hover:bg-slate-100"),children:[(0,l.jsx)("svg",{className:"w-4 h-4 shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:(0,l.jsx)("path",{d:"M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"})}),(0,l.jsx)("span",{className:"truncate",children:e})]},e)),N&&(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm",onClick:()=>{k(!1),S("")},children:(0,l.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl border border-slate-200 p-6 max-w-sm w-full mx-4",onClick:e=>e.stopPropagation(),children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,l.jsx)("div",{className:"p-2 rounded-xl bg-teal-100",children:(0,l.jsx)("svg",{className:"w-5 h-5 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zm10 0a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zm10 0a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),(0,l.jsx)("h3",{className:"font-bold text-lg text-slate-800",children:"Create workspace"})]}),(0,l.jsx)("p",{className:"text-sm text-slate-500 mb-4",children:"Workspaces help you organize files into separate project areas."}),(0,l.jsx)("input",{type:"text",value:C,onChange:e=>S(e.target.value),placeholder:"Enter workspace name",className:"w-full px-4 py-2.5 text-sm border border-slate-200 rounded-xl mb-4 focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none",onKeyDown:e=>"Enter"===e.key&&O(),autoFocus:!0}),(0,l.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,l.jsx)("button",{onClick:()=>{k(!1),S("")},className:"px-4 py-2 text-sm text-slate-600 hover:bg-slate-100 rounded-xl transition-colors",children:"Cancel"}),(0,l.jsx)("button",{onClick:O,className:"px-4 py-2 text-sm bg-teal-600 text-white rounded-xl hover:bg-teal-700 transition-colors",children:"Create workspace"})]})]})}),!N&&(0,l.jsxs)("button",{onClick:()=>k(!0),className:"w-full flex items-center gap-3 px-3 py-2 text-left text-sm text-slate-500 hover:bg-slate-100 rounded-xl",children:[(0,l.jsx)("svg",{className:"w-4 h-4 shrink-0 text-teal-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zm10 0a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zm10 0a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),(0,l.jsx)("span",{children:"New workspace"})]}),(0,l.jsx)("div",{className:"my-3 border-t border-slate-200"}),(0,l.jsx)("div",{className:"px-3 py-1",children:(0,l.jsx)("span",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:"Recents"})}),0===x.length?(0,l.jsx)("p",{className:"px-3 py-2 text-xs text-slate-400",children:"No recent items"}):x.slice(0,8).map(e=>(0,l.jsx)("button",{onClick:()=>o(e),className:"w-full flex items-center gap-2 px-3 py-2 text-left text-xs text-slate-600 hover:bg-slate-100 rounded-lg truncate",title:e,children:(0,l.jsx)("span",{className:"truncate",children:e.split("/").pop()||"Workspace"})},e)),j.length>0&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"my-3 border-t border-slate-200"}),(0,l.jsx)("div",{className:"px-3 py-1",children:(0,l.jsx)("span",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:"Favorites"})}),j.slice(0,8).map(e=>(0,l.jsxs)("button",{onClick:()=>o(e),className:"w-full flex items-center gap-2 px-3 py-2 text-left text-xs text-slate-600 hover:bg-slate-100 rounded-lg truncate",title:e,children:[(0,l.jsx)("span",{className:"text-amber-500",children:"★"}),(0,l.jsx)("span",{className:"truncate",children:e.split("/").pop()||e})]},e))]}),w.length>0&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"my-3 border-t border-slate-200"}),(0,l.jsx)("div",{className:"px-3 py-1",children:(0,l.jsx)("span",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:"Shared with me"})}),w.slice(0,8).map(e=>(0,l.jsxs)("button",{onClick:()=>o(e),className:"w-full flex items-center gap-2 px-3 py-2 text-left text-xs text-slate-600 hover:bg-slate-100 rounded-lg truncate",title:e,children:[(0,l.jsx)("svg",{className:"w-3.5 h-3.5 text-slate-400 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),(0,l.jsx)("span",{className:"truncate",children:e.split("/").pop()||e})]},e))]}),(0,l.jsx)("div",{className:"my-3 border-t border-slate-200"}),(0,l.jsx)("div",{className:"px-3 py-1",children:(0,l.jsx)("span",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:"Tags"})}),0===m.length?(0,l.jsx)("p",{className:"px-3 py-2 text-xs text-slate-400",children:"No tags yet"}):m.map(e=>(0,l.jsxs)("button",{onClick:()=>i&&i(e),className:"w-full flex items-center gap-2 px-3 py-2 text-left text-xs text-slate-600 hover:bg-slate-100 rounded-lg",children:[(0,l.jsx)("span",{className:"w-2 h-2 rounded-full bg-purple-400 shrink-0"}),e]},e))]}),u&&(0,l.jsxs)("div",{className:"p-3 border-t border-slate-200 bg-white/50 rounded-bl-2xl",children:[(0,l.jsx)("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-500 mb-1",children:"Storage"}),(0,l.jsxs)("div",{className:"text-sm font-medium text-slate-700",children:[u.used," of ",u.max||"—"," used"]}),u.maxBytes>0&&(0,l.jsx)("div",{className:"mt-1 h-1.5 bg-slate-200 rounded-full overflow-hidden",children:(0,l.jsx)("div",{className:"h-full bg-purple-500 rounded-full transition-all",style:{width:"".concat(Math.min(100,u.usedBytes/u.maxBytes*100),"%")}})}),(0,l.jsxs)("div",{className:"text-xs text-slate-500 mt-1",children:[u.fileCount," items \xb7 ",u.location]})]})]})}function h(e){let{path:t,name:s,onClose:n,onMetaUpdate:o,onShowError:i}=e,[c,d]=(0,a.useState)(null),[x,h]=(0,a.useState)({tags:[],comments:"",starred:!1}),[u,p]=(0,a.useState)(null),[m,f]=(0,a.useState)(""),[b,g]=(0,a.useState)(!1);async function j(){if(t){g(!0);try{await fetch("".concat(r.S,"/api/file-manager/meta"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:t,meta:{tags:x.tags,comments:x.comments,starred:x.starred}})}),o&&o()}finally{g(!1)}}}async function v(){if(!t)return;let e=!x.starred;h(t=>({...t,starred:e}));try{await fetch("".concat(r.S,"/api/file-manager/meta"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:t,meta:{starred:e}})}),o&&o()}catch(t){h(t=>({...t,starred:!e}))}}async function w(){if(t){try{let e=await fetch("".concat(r.S,"/api/file-manager/share"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:t})}),s=await e.json();if(s.error)throw Error(s.error);let l=s.link||"".concat(window.location.origin,"/share/").concat(s.token);p(l),l&&navigator.clipboard&&await navigator.clipboard.writeText(l)}catch(e){i?i(e.message||"Failed to create link"):alert(e.message||"Failed to create link")}o&&o()}}function y(){let e=m.trim();!e||x.tags.includes(e)||(h(t=>({...t,tags:[...t.tags,e]})),f(""))}return((0,a.useEffect)(()=>{if(!t){d(null),h({tags:[],comments:"",starred:!1}),p(null);return}fetch("".concat(r.S,"/api/file-manager/stat?path=").concat(encodeURIComponent(t))).then(e=>e.json()).then(d).catch(()=>d(null)),fetch("".concat(r.S,"/api/file-manager/meta")).then(e=>e.json()).then(e=>{let s=(e.meta||{})[t]||{};h({tags:s.tags||[],comments:s.comments||"",starred:!!s.starred});let l=(e.sharedLinks||{})[t];if(null==l?void 0:l.token){let e=window.location.origin;p("".concat(e,"/share/").concat(l.token))}else p(null)}).catch(()=>{})},[t]),t)?(0,l.jsxs)("div",{className:"w-72 shrink-0 flex flex-col bg-white border-l border-slate-200 rounded-r-2xl overflow-hidden",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-slate-200",children:[(0,l.jsx)("span",{className:"text-sm font-semibold text-slate-800",children:"Info"}),(0,l.jsx)("button",{onClick:n,className:"p-1 text-slate-400 hover:text-slate-600 rounded",children:(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,l.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 scrollbar-thin",children:c?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-12 h-12 rounded-lg bg-purple-100 flex items-center justify-center",children:"Folder"===c.kind?(0,l.jsx)("svg",{className:"w-6 h-6 text-purple-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,l.jsx)("path",{d:"M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"})}):(0,l.jsx)("svg",{className:"w-6 h-6 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,l.jsxs)("div",{className:"min-w-0",children:[(0,l.jsx)("div",{className:"font-semibold text-slate-800 truncate",children:c.name}),(0,l.jsx)("div",{className:"text-xs text-slate-500",children:c.modified?new Date(c.modified).toLocaleString():""}),c.size&&(0,l.jsx)("div",{className:"text-xs text-slate-600 font-medium",children:c.size})]})]}),(0,l.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-slate-500",children:"Kind"}),(0,l.jsx)("span",{className:"text-slate-800",children:c.kind})]}),c.size&&(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-slate-500",children:"Size"}),(0,l.jsx)("span",{className:"text-slate-800",children:c.size})]}),null!=c.itemCount&&(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-slate-500",children:"Items"}),(0,l.jsx)("span",{className:"text-slate-800",children:c.itemCount})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-slate-500",children:"Created"}),(0,l.jsx)("span",{className:"text-slate-800",children:c.created?new Date(c.created).toLocaleString():"—"})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-slate-500",children:"Modified"}),(0,l.jsx)("span",{className:"text-slate-800",children:c.modified?new Date(c.modified).toLocaleString():"—"})]}),(0,l.jsxs)("div",{className:"pt-2",children:[(0,l.jsx)("span",{className:"text-slate-500 block mb-1",children:"Where"}),(0,l.jsx)("span",{className:"text-slate-800 text-xs font-mono break-all",children:c.where})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-xs font-bold uppercase tracking-wider text-slate-500 block mb-2",children:"Tags"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-1 mb-2",children:x.tags.map(e=>(0,l.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-purple-100 text-purple-700 text-xs",children:[e,(0,l.jsx)("button",{type:"button",onClick:()=>{h(t=>({...t,tags:t.tags.filter(t=>t!==e)}))},className:"hover:text-purple-900",children:"\xd7"})]},e))}),(0,l.jsxs)("div",{className:"flex gap-1",children:[(0,l.jsx)("input",{type:"text",value:m,onChange:e=>f(e.target.value),onKeyDown:e=>"Enter"===e.key&&y(),placeholder:"Add tag...",className:"flex-1 px-2 py-1.5 text-sm border border-slate-200 rounded focus:ring-2 focus:ring-purple-500 outline-none"}),(0,l.jsx)("button",{type:"button",onClick:y,className:"px-2 py-1.5 bg-purple-600 text-white text-sm rounded hover:bg-purple-700",children:"Add"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-xs font-bold uppercase tracking-wider text-slate-500 block mb-2",children:"Comments"}),(0,l.jsx)("textarea",{value:x.comments,onChange:e=>h(t=>({...t,comments:e.target.value})),rows:3,placeholder:"Add a comment...",className:"w-full px-3 py-2 text-sm border border-slate-200 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none resize-none"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("button",{type:"button",onClick:v,className:"flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium ".concat(x.starred?"bg-amber-100 text-amber-800":"bg-slate-100 text-slate-700 hover:bg-slate-200"),children:[(0,l.jsx)("span",{children:x.starred?"★":"☆"}),x.starred?"Favorited":"Add to Favorites"]}),(0,l.jsxs)("button",{type:"button",onClick:w,className:"flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium bg-slate-100 text-slate-700 hover:bg-slate-200",children:["\uD83D\uDD17 ",u?"Copy link":"Get link"]})]}),u&&(0,l.jsxs)("div",{className:"text-xs",children:[(0,l.jsx)("span",{className:"text-slate-500 block mb-1",children:"Public link"}),(0,l.jsx)("input",{type:"text",readOnly:!0,value:u,className:"w-full px-2 py-1.5 border border-slate-200 rounded bg-slate-50 text-slate-600 truncate"})]}),(0,l.jsx)("button",{onClick:()=>{j()},disabled:b,className:"w-full py-2 bg-slate-900 text-white text-sm font-medium rounded-lg hover:bg-slate-800 disabled:opacity-50",children:b?"Saving…":"Save info"})]}):(0,l.jsx)("p",{className:"text-slate-500 text-sm",children:"Loading…"})})]}):null}function u(e){let{x:t,y:s,onClose:r,items:n}=e,[o,i]=(0,a.useState)(null);return t&&s?(0,l.jsx)("div",{className:"fixed z-50 bg-white rounded-lg shadow-xl border border-slate-200 py-1 min-w-[180px]",style:{left:"".concat(t,"px"),top:"".concat(s,"px")},onClick:e=>e.stopPropagation(),children:n.map((e,t)=>e.subItems?(0,l.jsxs)("div",{className:"relative group",onMouseEnter:()=>i(t),onMouseLeave:()=>i(null),children:[(0,l.jsxs)("div",{className:"w-full text-left px-4 py-2 text-sm flex items-center justify-between gap-3 cursor-default ".concat(o===t?"bg-slate-50":"text-slate-700 hover:bg-slate-50"),children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("span",{children:e.icon}),(0,l.jsx)("span",{children:e.label})]}),(0,l.jsx)("svg",{className:"w-4 h-4 text-slate-400 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),o===t&&(0,l.jsx)("div",{className:"absolute left-full top-0 ml-0 py-1 bg-white rounded-lg shadow-xl border border-slate-200 min-w-[160px] z-50",onMouseEnter:()=>i(t),onMouseLeave:()=>i(null),children:e.subItems.map((e,t)=>(0,l.jsxs)("button",{onClick:()=>{e.onClick(),r()},className:"w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-50 flex items-center gap-3",children:[e.icon,(0,l.jsx)("span",{children:e.label})]},t))})]},t):(0,l.jsxs)("button",{onClick:()=>{e.onClick(),r()},className:"w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-50 flex items-center gap-3",children:[e.icon,(0,l.jsx)("span",{children:e.label})]},t))}):null}function p(e){let{item:t,onRightClick:s,onDoubleClick:a,viewMode:r,selected:n,onSelect:o,onShiftSelect:i}=e,c=/\.(jpg|jpeg|png|gif|bmp|svg)$/i.test(t.name),d="directory"===t.type,x=e=>{e.shiftKey?i(t):o(t,e.ctrlKey||e.metaKey)},h=()=>a(t);return"grid"===r?(0,l.jsxs)("div",{className:"group relative rounded-lg border transition-all cursor-pointer p-4 ".concat(n?"bg-purple-50 border-purple-400 ring-2 ring-purple-200":"bg-white border-slate-200 hover:border-purple-300 hover:shadow-md"),onClick:x,onContextMenu:e=>{e.preventDefault(),e.stopPropagation(),s(e,t)},onDoubleClick:e=>{e.stopPropagation(),h()},children:[(0,l.jsx)("div",{className:"absolute top-2 left-2 z-10",children:(0,l.jsx)("input",{type:"checkbox",checked:n,onChange:()=>o(t,!0),onClick:e=>e.stopPropagation(),className:"rounded border-slate-300 text-purple-600 focus:ring-purple-500"})}),(0,l.jsx)("div",{className:"flex flex-col items-center justify-center h-32 mb-2",children:d?(0,l.jsx)("svg",{className:"w-16 h-16 text-purple-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,l.jsx)("path",{d:"M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"})}):c?(0,l.jsx)("div",{className:"w-16 h-16 bg-slate-100 rounded flex items-center justify-center text-xs text-slate-400",children:"\uD83D\uDDBC️"}):(0,l.jsx)("svg",{className:"w-16 h-16 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,l.jsx)("div",{className:"text-xs text-slate-700 text-center truncate w-full",title:t.name,children:t.name})]}):(0,l.jsxs)("div",{className:"group flex items-center gap-3 px-4 py-2 rounded-lg cursor-pointer border ".concat(n?"bg-purple-50 border-purple-200":"hover:bg-slate-50 border-transparent hover:border-slate-200"),onClick:x,onContextMenu:e=>{e.preventDefault(),e.stopPropagation(),s(e,t)},onDoubleClick:e=>{e.stopPropagation(),h()},children:[(0,l.jsx)("input",{type:"checkbox",checked:n,onChange:()=>o(t,!0),onClick:e=>e.stopPropagation(),className:"rounded border-slate-300 text-purple-600 focus:ring-purple-500 shrink-0"}),d?(0,l.jsx)("svg",{className:"w-5 h-5 text-purple-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,l.jsx)("path",{d:"M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"})}):(0,l.jsx)("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,l.jsx)("span",{className:"flex-1 text-sm text-slate-700 truncate",children:t.name}),(0,l.jsx)("span",{className:"text-xs text-slate-400",children:t.size||"-"})]})}function m(e){var t,s;let{currentPath:n,onNavigate:o,onOperation:i}=e,[m,f]=(0,a.useState)([]),[b,g]=(0,a.useState)(!0),[j,v]=(0,a.useState)({x:null,y:null,item:null}),[w,y]=(0,a.useState)("grid"),[N,k]=(0,a.useState)(!1),[C,S]=(0,a.useState)(""),[L,M]=(0,a.useState)(new Set),[D,z]=(0,a.useState)(null),[T,O]=(0,a.useState)(null),[E,B]=(0,a.useState)(""),[R,W]=(0,a.useState)(null),[_,P]=(0,a.useState)(null),[F,H]=(0,a.useState)(!0),[I,V]=(0,a.useState)(!1),[A,U]=(0,a.useState)(!1),[J,K]=(0,a.useState)(null),[q,X]=(0,a.useState)(null),[G,Y]=(0,a.useState)(!1),[Z,$]=(0,a.useState)(""),[Q,ee]=(0,a.useState)(null),[et,es]=(0,a.useState)(!1),el=(0,a.useRef)(-1),ea=(0,a.useRef)(null),er=(0,a.useRef)(null),en=(0,a.useRef)(()=>{});(0,a.useEffect)(()=>{ei()},[n]),(0,a.useEffect)(()=>{n&&fetch("".concat(r.S,"/api/file-manager/meta"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:n,recents:!0})}).catch(()=>{})},[n]);let eo=(0,a.useRef)(E);async function ei(){g(!0),M(new Set);try{let e=await fetch("".concat(r.S,"/api/file-manager/list?path=").concat(encodeURIComponent(n||""))),t=await e.json();t.items&&f(t.items)}catch(e){console.error("Failed to fetch items:",e)}finally{g(!1)}}function ec(e,t){M(s=>{let l=new Set(s);return t?l.has(e.path)?l.delete(e.path):l.add(e.path):(l.clear(),l.add(e.path)),l})}function ed(e){let t=m.findIndex(t=>t.path===e.path);if(-1===t)return;let s=el.current>=0?Math.min(el.current,t):t,l=el.current>=0?Math.max(el.current,t):t;M(e=>{let t=new Set(e);for(let e=s;e<=l;e++)t.add(m[e].path);return t})}function ex(e){let t=m.findIndex(t=>t.path===e.path);el.current=t}function eh(e,t){v({x:e.clientX,y:e.clientY,item:t})}function eu(e){"directory"===e.type?(em(),o(e.path),ep(e.path)):(0,d.e)(e.name)&&(O({path:e.path,name:e.name}),ep(e.path))}function ep(e){fetch("".concat(r.S,"/api/file-manager/meta"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:e,recents:!0})}).catch(()=>{})}function em(){B(""),W(null)}function ef(e){z(e),v({x:null,y:null,item:null})}async function eb(){if(!D||0===D.length)return;let e=[...D],t=e.map(e=>e.path);if(z(null),1===t.length){try{let e=await fetch("".concat(r.S,"/api/file-manager/delete"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:t[0]})}),s=await e.json();if(!e.ok)throw Error(s.error||"Delete failed");s.operation&&i(s.operation),ei(),en.current()}catch(t){z(e),X(t.message||"Delete failed")}return}try{let e=await fetch("".concat(r.S,"/api/file-manager/delete-bulk"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paths:t})}),s=await e.json();if(!e.ok)throw Error(s.error||"Delete failed");(s.operations||[]).forEach(e=>i(e)),ei(),en.current()}catch(t){z(e),X(t.message||"Delete failed")}}async function eg(){j.item&&ef([j.item])}async function ej(){if(!j.item)return;let e=j.item,t=prompt("Enter new name:",e.name);if(t&&t!==e.name){try{let s=await fetch("".concat(r.S,"/api/file-manager/rename"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:e.path,newName:t})}),l=await s.json();l.operation&&i(l.operation),ei(),en.current()}catch(e){console.error("Rename failed:",e)}v({x:null,y:null,item:null})}}async function ev(){if(j.item&&"directory"!==j.item.type){try{let e=await fetch("".concat(r.S,"/api/file-manager/download?path=").concat(encodeURIComponent(j.item.path))),t=await e.blob(),s=window.URL.createObjectURL(t),l=document.createElement("a");l.href=s,l.download=j.item.name,l.click(),window.URL.revokeObjectURL(s)}catch(e){console.error("Download failed:",e)}v({x:null,y:null,item:null})}}async function ew(){if(C.trim())try{let e=await fetch("".concat(r.S,"/api/file-manager/create-folder"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:n||"",name:C.trim()})}),t=await e.json();t.operation&&i(t.operation),S(""),k(!1),ei(),en.current()}catch(e){console.error("Create folder failed:",e)}}async function ey(e){for(let t of Array.from(e.target.files)){let e=new FormData;e.append("file",t),e.append("path",n||"");try{let t=await fetch("".concat(r.S,"/api/file-manager/upload"),{method:"POST",body:e}),s=await t.json();s.operation&&i(s.operation)}catch(e){console.error("Upload failed:",e)}}ei(),er.current.value="",en.current()}async function eN(){var e;if(!(null===(e=j.item)||void 0===e?void 0:e.path))return;let t=j.item.path;try{await fetch("".concat(r.S,"/api/file-manager/meta"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:t,meta:{starred:!A}})}),en.current()}catch(e){console.error(e)}v({x:null,y:null,item:null})}async function ek(){let e=Z.trim();if(e){es(!0),ee(null);try{let t=await fetch("".concat(r.S,"/api/file-manager/ai-command"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e,currentPath:n||""})}),s=await t.json();if(!t.ok)throw Error(s.error||"AI command failed");ee(s),["list","create_folder","move","delete","search"].includes(s.action)&&(ei(),en.current())}catch(e){ee({error:e.message})}finally{es(!1)}}}async function eC(){var e;if(!(null===(e=j.item)||void 0===e?void 0:e.path))return;let t=j.item.path;try{let e=await fetch("".concat(r.S,"/api/file-manager/share"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:t})}),s=await e.json();if(s.error)throw Error(s.error);s.link&&(await navigator.clipboard.writeText(s.link),K({link:s.link})),en.current()}catch(e){K({error:e.message||"Share failed"})}v({x:null,y:null,item:null})}eo.current=E,(0,a.useEffect)(()=>{let e=E.trim();if(!e){W(null);return}let t=setTimeout(()=>{eo.current.trim()===e&&fetch("".concat(r.S,"/api/file-manager/search?q=").concat(encodeURIComponent(e))).then(e=>e.json()).then(e=>W(e.items||[])).catch(()=>W([]))},320);return()=>clearTimeout(t)},[E]),(0,a.useEffect)(()=>{let e=()=>v({x:null,y:null,item:null});return window.addEventListener("click",e),()=>window.removeEventListener("click",e)},[]),(0,a.useEffect)(()=>{if(J||q)return ea.current=setTimeout(()=>{K(null),X(null)},5e3),()=>{ea.current&&clearTimeout(ea.current)}},[J,q]),(0,a.useEffect)(()=>{var e;if(!(null===(e=j.item)||void 0===e?void 0:e.path)){U(!1);return}fetch("".concat(r.S,"/api/file-manager/meta")).then(e=>e.json()).then(e=>{var t;return U(!!(null===(t=(e.meta||{})[j.item.path])||void 0===t?void 0:t.starred))}).catch(()=>U(!1))},[null===(t=j.item)||void 0===t?void 0:t.path]);let eS=j.item?[{label:"Get Info",icon:"ℹ️",onClick:()=>{P(j.item),H(!0)}},{label:A?"Remove from Favorites":"Add to Favorites",icon:"★",onClick:eN},..."directory"===j.item.type?[{label:"Open",icon:"\uD83D\uDCC2",onClick:()=>eu(j.item)},{label:"Share",icon:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})}),subItems:[{label:"Share",icon:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})}),onClick:eC},{label:"Copy link",icon:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),onClick:eC}]},{label:"Rename",icon:"✏️",onClick:ej}]:[...(0,d.e)(j.item.name)?[{label:"View",icon:"\uD83D\uDC41️",onClick:()=>O({path:j.item.path,name:j.item.name})}]:[],{label:"Download",icon:"⬇️",onClick:ev},{label:"Share",icon:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})}),subItems:[{label:"Share",icon:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})}),onClick:eC},{label:"Copy link",icon:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),onClick:eC}]},{label:"Rename",icon:"✏️",onClick:ej}],{label:"Delete",icon:"\uD83D\uDDD1️",onClick:eg}]:[{label:"New folder",icon:"\uD83D\uDCC1",onClick:()=>{k(!0)}},{label:"Upload files",icon:"⬆️",onClick:function(){var e;null===(e=er.current)||void 0===e||e.click()}},{label:"Refresh",icon:"\uD83D\uDD04",onClick:ei}],eL=n?n.split("/").filter(Boolean):[],eM=[{name:"My Files",path:""},...eL.map((e,t)=>({name:e,path:eL.slice(0,t+1).join("/")}))],eD=null!==R?R.map(e=>({path:e.path,name:e.name,type:e.type,size:null})):m,ez=null!==R;return(0,l.jsx)("div",{className:"h-full flex flex-col bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden",children:(0,l.jsxs)("div",{className:"flex flex-1 min-h-0",children:[(0,l.jsx)(x,{collapsed:I,onToggleCollapse:()=>V(e=>!e),currentPath:n,onNavigate:e=>{em(),o(e)},onSearchClick:e=>B(e),onRefreshMeta:en,onShowError:e=>K({error:e})}),(0,l.jsxs)("div",{className:"flex-1 flex flex-col min-w-0",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between px-5 py-4 border-b border-slate-200 flex-wrap gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[(0,l.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,l.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none",children:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,l.jsx)("input",{type:"search",value:E,onChange:e=>B(e.target.value),placeholder:"Search (type to search)",className:"w-full pl-9 pr-4 py-2.5 border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500 outline-none"})]}),!ez&&(0,l.jsx)("div",{className:"flex items-center gap-2",children:eM.map((e,t)=>(0,l.jsxs)("button",{onClick:()=>o(e.path),className:"text-sm ".concat(t===eM.length-1?"text-slate-900 font-semibold":"text-slate-500 hover:text-purple-600"),children:[e.name,t<eM.length-1&&(0,l.jsx)("span",{className:"mx-2",children:"/"})]},t))})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3 shrink-0",children:[(0,l.jsx)("button",{onClick:()=>Y(e=>!e),className:"p-2.5 rounded-xl transition-colors ".concat(G?"bg-purple-100 text-purple-600":"text-slate-400 hover:bg-slate-100"),title:"AI command (e.g. list files, create folder Reports)",children:(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),(0,l.jsx)("button",{onClick:()=>H(e=>!e),className:"p-2.5 rounded-xl transition-colors ".concat(F?"bg-purple-100 text-purple-600":"text-slate-400 hover:bg-slate-100"),title:"Toggle info panel",children:(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),ez&&(0,l.jsx)("button",{type:"button",onClick:em,className:"px-3 py-2 text-slate-500 hover:text-slate-700 text-sm rounded-xl hover:bg-slate-100",children:"Clear search"}),L.size>0&&(0,l.jsxs)("button",{onClick:function(){let e=m.filter(e=>L.has(e.path));0!==e.length&&ef(e)},className:"px-4 py-2 text-sm bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors",children:["Delete (",L.size,")"]}),(0,l.jsx)("button",{onClick:()=>k(!0),className:"px-4 py-2 text-sm bg-purple-600 text-white rounded-xl hover:bg-purple-700 transition-colors",children:"+ New Folder"}),(0,l.jsxs)("label",{className:"px-4 py-2 text-sm bg-slate-100 text-slate-700 rounded-xl hover:bg-slate-200 transition-colors cursor-pointer",children:["Upload",(0,l.jsx)("input",{ref:er,type:"file",multiple:!0,className:"hidden",onChange:ey})]}),(0,l.jsxs)("div",{className:"flex border border-slate-200 rounded-xl overflow-hidden",children:[(0,l.jsx)("button",{onClick:()=>y("grid"),className:"px-3 py-2 text-xs font-medium ".concat("grid"===w?"bg-purple-600 text-white":"bg-white text-slate-600 hover:bg-slate-50"),children:"Grid"}),(0,l.jsx)("button",{onClick:()=>y("list"),className:"px-3 py-2 text-xs font-medium ".concat("list"===w?"bg-purple-600 text-white":"bg-white text-slate-600 hover:bg-slate-50"),children:"List"})]})]})]}),G&&(0,l.jsxs)("div",{className:"px-5 py-3 border-b border-slate-200 bg-slate-50/80",children:[(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("input",{type:"text",value:Z,onChange:e=>$(e.target.value),onKeyDown:e=>"Enter"===e.key&&ek(),placeholder:'Try: "list files", "create folder Reports", "search for pdf"',className:"flex-1 px-4 py-2 border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-purple-500 outline-none",disabled:et}),(0,l.jsx)("button",{onClick:ek,disabled:et||!Z.trim(),className:"px-4 py-2 bg-purple-600 text-white text-sm rounded-xl hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed",children:et?"...":"Run"})]}),Q&&(0,l.jsx)("div",{className:"mt-2 p-3 rounded-lg text-sm ".concat(Q.error?"bg-red-50 text-red-700":"bg-white border border-slate-200 text-slate-700"),children:Q.error?Q.error:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"font-medium text-purple-600",children:Q.action}),null!=Q.count&&" \xb7 ".concat(Q.count," items"),(null===(s=Q.items)||void 0===s?void 0:s.length)>0&&(0,l.jsxs)("ul",{className:"mt-1 max-h-24 overflow-y-auto text-xs font-mono",children:[Q.items.slice(0,10).map((e,t)=>(0,l.jsxs)("li",{children:[e.name," (",e.type,")"]},t)),Q.items.length>10&&(0,l.jsxs)("li",{children:["…and ",Q.items.length-10," more"]})]})]})})]}),N&&(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm",onClick:()=>k(!1),children:(0,l.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-sm w-full mx-4",onClick:e=>e.stopPropagation(),children:[(0,l.jsx)("h3",{className:"font-bold text-lg mb-4",children:"Create Folder"}),(0,l.jsx)("input",{type:"text",value:C,onChange:e=>S(e.target.value),onKeyDown:e=>"Enter"===e.key&&ew(),placeholder:"Folder name",className:"w-full px-4 py-2 border border-slate-300 rounded-lg mb-4 focus:ring-2 focus:ring-purple-500 outline-none",autoFocus:!0}),(0,l.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,l.jsx)("button",{onClick:()=>k(!1),className:"px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg",children:"Cancel"}),(0,l.jsx)("button",{onClick:ew,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Create"})]})]})}),(0,l.jsx)(c,{targets:D,onConfirm:eb,onCancel:()=>z(null)}),(0,l.jsx)(d.Z,{filePath:null==T?void 0:T.path,fileName:null==T?void 0:T.name,onClose:()=>O(null)}),(0,l.jsx)(u,{x:j.x,y:j.y,items:eS,onClose:()=>v({x:null,y:null,item:null})}),(J||q)&&(0,l.jsxs)("div",{className:"fixed bottom-6 left-6 z-[70] flex items-center gap-4 px-5 py-3 rounded-xl shadow-xl border ".concat(q?"bg-red-600 text-white border-red-700":"bg-slate-800 text-white border-slate-700"),children:[(0,l.jsx)("span",{className:"text-sm font-medium",children:q||(J.error?J.error:"Link copied")}),J.link&&(0,l.jsx)("a",{href:J.link,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-purple-300 hover:text-purple-200 underline",children:"Manage access"}),(0,l.jsx)("button",{onClick:()=>{K(null),X(null)},className:"p-1 rounded-full hover:bg-black/20 text-white/90 hover:text-white transition-colors","aria-label":"Close",children:(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,l.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 scrollbar-thin min-h-0",onContextMenu:function(e){e.preventDefault(),v({x:e.clientX,y:e.clientY,item:null})},children:[ez&&(0,l.jsxs)("p",{className:"text-sm text-slate-500 mb-2",children:['Search results for "',E,'"']}),b?(0,l.jsx)("div",{className:"flex items-center justify-center h-64 text-slate-400",children:"Loading..."}):0===eD.length?(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-slate-400",children:[(0,l.jsx)("svg",{className:"w-16 h-16 mb-4 opacity-30",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"})}),(0,l.jsx)("p",{children:ez?"No results":"Empty folder"})]}):"grid"===w?(0,l.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:eD.map(e=>(0,l.jsx)(p,{item:e,onRightClick:eh,onDoubleClick:e=>{ex(e),eu(e)},viewMode:"grid",selected:L.has(e.path),onSelect:(e,t)=>{ex(e),ec(e,t)},onShiftSelect:ed},e.path))}):(0,l.jsx)("div",{className:"space-y-1",children:eD.map(e=>(0,l.jsx)(p,{item:e,onRightClick:eh,onDoubleClick:e=>{ex(e),eu(e)},viewMode:"list",selected:L.has(e.path),onSelect:(e,t)=>{ex(e),ec(e,t)},onShiftSelect:ed},e.path))})]})]}),F&&_&&(0,l.jsx)(h,{path:null==_?void 0:_.path,name:null==_?void 0:_.name,onClose:()=>{P(null),H(!1)},onMetaUpdate:()=>en.current(),onShowError:e=>K({error:e})})]})})}function f(){return(0,l.jsxs)("div",{className:"flex items-center gap-4 select-none group",children:[(0,l.jsxs)("div",{className:"relative w-12 h-12 flex items-center justify-center bg-white rounded-2xl shadow-[0_8px_30px_rgb(0,0,0,0.04)] border border-slate-100 transform group-hover:scale-110 group-hover:rotate-3 transition-all duration-300",children:[(0,l.jsx)("div",{className:"absolute inset-0 bg-gradient-to-tr from-purple-500/10 to-blue-500/10 rounded-2xl"}),(0,l.jsx)("svg",{className:"w-7 h-7 text-purple-600 relative z-10",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-extrabold tracking-tight text-slate-900",children:"File Organizer"}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"h-px w-6 bg-purple-300"}),(0,l.jsx)("p",{className:"text-xs font-bold text-purple-600 tracking-widest uppercase",children:"OS Concepts Demo"})]})]})]})}let b={mkdir:{name:"mkdir",summary:"Create a directory",desc:"The `mkdir` system call creates a new directory with the specified name and mode (permissions). It's the fundamental way folders are created in Unix-like systems.",c_code:'\n#include <sys/stat.h>\n\nint status = mkdir("path/to/folder", 0777);\n\nif (status == 0) {\n    // Directory created\n} else {\n    // Error handling\n}',node_code:"\nimport fs from 'fs/promises';\n\nawait fs.mkdir('path/to/folder', { recursive: true });\n"},open:{name:"open",summary:"Open or create a file",desc:"The `open` syscall opens a file. If called with `O_CREAT`, it creates a new file. It returns a file descriptor (an integer) used for subsequent read/write operations.",c_code:'\n#include <fcntl.h>\n\n// Open for writing, create if not exists\nint fd = open("file.txt", O_WRONLY | O_CREAT, 0644);',node_code:"\nimport fs from 'fs/promises';\n\n// High-level wrapper often used instead of raw open\nconst fileHandle = await fs.open('file.txt', 'w');\n"},write:{name:"write",summary:"Write data to a file",desc:"Writes a sequence of bytes from a buffer to an open file descriptor.",c_code:'\n#include <unistd.h>\n\nconst char *data = "Hello Kernel";\nwrite(fd, data, strlen(data));',node_code:"\n// In Node, we often use high-level methods:\nawait fs.writeFile('file.txt', 'Hello User space');\n\n// Or with a handle:\nawait fileHandle.write('Data');\n"},readdir:{name:"getdents / readdir",summary:"Read directory entries",desc:"Reads the contents of a directory. In C, `readdir` (libc) uses the `getdents` system call underneath to get the list of files and subfolders.",c_code:'\n#include <dirent.h>\n\nDIR *d = opendir(".");\nstruct dirent *dir;\nwhile ((dir = readdir(d)) != NULL) {\n    printf("%s\\n", dir->d_name);\n}\nclosedir(d);',node_code:"\nimport fs from 'fs/promises';\n\nconst files = await fs.readdir('.'); \n// Returns array of filenames\n"},rename:{name:"rename",summary:"Move or rename a file",desc:"Renames a file, moving it between directories if necessary. It is an atomic operation on POSIX systems.",c_code:'\n#include <stdio.h>\n\n// Move/Rename is just one call\nrename("old_folder/file.txt", "new_folder/file.txt");',node_code:"\nimport fs from 'fs/promises';\n\nawait fs.rename('old.txt', 'new.txt');\n"},unlink:{name:"unlink",summary:"Delete a file",desc:"Deletes a name from the filesystem. If that name was the last link to a file and no processes have it open, the file is deleted and the space it was using is made available for reuse.",c_code:'\n#include <unistd.h>\n\nint status = unlink("file_to_delete.txt");',node_code:"\nimport fs from 'fs/promises';\n\nawait fs.unlink('file_to_delete.txt');\n"},rmdir:{name:"rmdir",summary:"Delete a directory",desc:"Deletes a directory, which must be empty.",c_code:'\n#include <unistd.h>\n\nint status = rmdir("empty_folder");',node_code:"\nimport fs from 'fs/promises';\n\nawait fs.rmdir('empty_folder');\n"}};function g(e){let{syscall:t,onClose:s}=e,a=Object.values(b).find(e=>t.toLowerCase().includes(e.name.toLowerCase()));return a?(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/40 backdrop-blur-sm",onClick:s,children:(0,l.jsxs)("div",{className:"glass-panel w-full max-w-2xl rounded-2xl shadow-2xl p-6 relative bg-white",onClick:e=>e.stopPropagation(),children:[(0,l.jsx)("button",{onClick:s,className:"absolute top-4 right-4 text-slate-400 hover:text-slate-600",children:(0,l.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,l.jsx)("div",{className:"p-3 bg-purple-100 text-purple-600 rounded-xl",children:(0,l.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("h3",{className:"text-xl font-bold text-slate-900",children:[a.name," ",(0,l.jsx)("span",{className:"text-slate-400 font-normal text-base ml-1",children:"syscall"})]}),(0,l.jsx)("p",{className:"text-purple-600 font-medium text-sm",children:a.summary})]})]}),(0,l.jsx)("p",{className:"text-slate-600 leading-relaxed mb-6",children:a.desc}),(0,l.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"bg-slate-900 rounded-xl p-4 overflow-hidden border border-slate-800",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2 border-b border-slate-700 pb-2",children:[(0,l.jsx)("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:"C Implementation"}),(0,l.jsx)("span",{className:"text-[10px] text-slate-500 font-mono",children:"system_call"})]}),(0,l.jsx)("pre",{className:"font-mono text-xs text-emerald-400 overflow-x-auto whitespace-pre-wrap",children:a.c_code.trim()})]}),(0,l.jsxs)("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-4 overflow-hidden",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2 border-b border-slate-200 pb-2",children:[(0,l.jsx)("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Node.js Equivalent"}),(0,l.jsx)("span",{className:"text-[10px] text-slate-400 font-mono",children:"wrapper"})]}),(0,l.jsx)("pre",{className:"font-mono text-xs text-slate-700 overflow-x-auto whitespace-pre-wrap",children:a.node_code.trim()})]})]}),(0,l.jsx)("div",{className:"mt-6 pt-4 border-t border-slate-100 flex justify-end",children:(0,l.jsx)("button",{onClick:s,className:"bg-slate-900 hover:bg-slate-800 text-white px-5 py-2 rounded-lg text-sm font-medium transition-colors",children:"Got it"})})]})}):null}function j(e){let{target:t,onConfirm:s,onCancel:a}=e;return t?(0,l.jsx)("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-slate-900/40 backdrop-blur-sm animate-in fade-in duration-200",children:(0,l.jsx)("div",{className:"bg-white rounded-2xl shadow-2xl p-6 max-w-sm w-full transform scale-100 animate-in zoom-in-95 duration-200 border border-slate-100",onClick:e=>e.stopPropagation(),children:(0,l.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-red-100 text-red-500 rounded-full flex items-center justify-center mb-4",children:(0,l.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),(0,l.jsx)("h3",{className:"text-lg font-bold text-slate-800 mb-2",children:"Delete Directory?"}),(0,l.jsxs)("p",{className:"text-sm text-slate-500 mb-6",children:["The folder ",(0,l.jsx)("span",{className:"font-mono bg-slate-100 px-1.5 py-0.5 rounded text-slate-700",children:t.path.split("/").pop()})," contains files. Are you sure you want to remove it?"]}),(0,l.jsxs)("div",{className:"flex gap-3 w-full",children:[(0,l.jsx)("button",{onClick:a,className:"flex-1 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 text-sm font-medium rounded-xl transition-colors",children:"Cancel"}),(0,l.jsx)("button",{onClick:s,className:"flex-1 px-4 py-2 bg-red-500 hover:bg-red-600 text-white text-sm font-medium rounded-xl shadow-lg shadow-red-200 transition-colors",children:"Delete"})]})]})})}):null}function v(e){let{o:t,onShowInfo:s}=e,a=!t.success;return(0,l.jsxs)("div",{className:"group flex items-center gap-3 px-4 py-3 border-l-4 text-sm font-mono transition-all hover:bg-slate-50 relative ".concat(a?"border-red-500 bg-red-50/10":"border-emerald-500"),children:[(0,l.jsxs)("button",{onClick:()=>s(t.syscall),className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity bg-white border border-slate-200 shadow-sm text-xs font-sans font-medium px-2 py-1 rounded-md text-purple-600 hover:text-purple-700 z-10 flex items-center gap-1",children:[(0,l.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Explain"]}),(0,l.jsx)("div",{className:"shrink-0 w-24 text-xs font-bold ".concat(a?"text-red-500":"text-emerald-600"),children:t.syscall.split("(")[0]}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,l.jsx)("span",{className:"text-slate-800 font-semibold",children:t.op}),(0,l.jsx)("span",{className:"text-slate-500 text-xs",children:"root/workspace/"}),(0,l.jsx)("span",{className:"text-purple-700 break-all",children:t.path}),t.path2&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"text-slate-400",children:"→"}),(0,l.jsx)("span",{className:"text-purple-700 break-all",children:t.path2})]})]}),(0,l.jsx)("div",{className:"text-slate-500 text-xs mt-1",children:t.description}),a&&(0,l.jsxs)("div",{className:"text-red-600 text-xs mt-1 font-bold",children:["Error: ",t.error]})]}),(0,l.jsxs)("div",{className:"text-xs text-slate-300 group-hover:text-slate-400",children:["ID: ",t.id]})]})}function w(){var e,t;let[s,n]=(0,a.useState)([]),[o,c]=(0,a.useState)(null),[d,x]=(0,a.useState)(null),[h,u]=(0,a.useState)(null),[p,b]=(0,a.useState)("my_folder_2"),[w,y]=(0,a.useState)("yadav.txt\nb.png\nc.mp3\ndoc.pdf"),[N,k]=(0,a.useState)(""),[C,S]=(0,a.useState)(null),[L,M]=(0,a.useState)(null),[D,z]=(0,a.useState)(null),[T,O]=(0,a.useState)(""),[E,B]=(0,a.useState)(!1),[R,W]=(0,a.useState)("os"),[_,P]=(0,a.useState)(""),[F,H]=(0,a.useState)([]),I=(0,a.useCallback)(async()=>{try{let e=await fetch("".concat(r.S,"/api/scenario/list-workspace")),t=await e.json();t.tree&&H(t.tree)}catch(e){console.error("Failed to fetch tree:",e)}},[]);(0,a.useEffect)(()=>{I()},[I]);let V=(function e(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];for(let a of t||[])if("directory"===a.type){var l;s.push({name:a.name,path:a.path}),(null===(l=a.children)||void 0===l?void 0:l.length)&&e(a.children,s)}return s})(F).filter(e=>{if(!T.trim())return!0;let t=T.toLowerCase();return e.name.toLowerCase().includes(t)||e.path.toLowerCase().includes(t)}),A=E?s.filter(e=>!e.success):s;async function U(e){try{let t=await fetch("".concat(r.S,"/api/scenario/delete"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({targetPath:e})}),s=await t.json();if(!s.success)throw Error(s.error);n(e=>[s.operation,...e]),I(),z(null)}catch(e){u(e.message)}}async function J(){x("create-dir"),u(null),n([]),c(null);let e=w.split(/\n/).map(e=>e.trim()).filter(Boolean);try{let t=await fetch("".concat(r.S,"/api/scenario/create-dir"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dirName:p,fileNames:e})}),s=await t.json();if(!t.ok)throw Error(s.error||"Request failed");n(s.operations||[]),c({type:"create-dir",result:s.result}),S(s.backend||null),I()}catch(e){u(e.message),e.operations&&n(e.operations)}finally{x(null)}}async function K(){x("organize"),u(null),n([]),c(null);try{let e=await fetch("".concat(r.S,"/api/scenario/organize"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({directoryPath:N||void 0})}),t=await e.json();if(!e.ok)throw Error(t.error||"Request failed");n(t.operations||[]),c({type:"organize",result:t.result}),S(t.backend||null),I()}catch(e){u(e.message)}finally{x(null)}}return(0,l.jsxs)("div",{className:"min-h-screen font-sans pb-24",children:[L&&(0,l.jsx)(g,{syscall:L,onClose:()=>M(null)}),(0,l.jsx)(j,{target:D,onConfirm:()=>U(D.path),onCancel:()=>z(null)}),(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-8",children:[(0,l.jsxs)("header",{className:"mb-8 flex items-center justify-between",children:[(0,l.jsx)(f,{}),C&&(0,l.jsxs)("div",{className:"glass-card px-4 py-1.5 rounded-full text-purple-700 text-xs font-semibold tracking-wide uppercase",children:["Backend: ","c"===C?"C (Syscalls)":"Node.js (Fallback)"]})]}),(0,l.jsxs)("div",{className:"mb-8 flex gap-2 border-b border-slate-200",children:[(0,l.jsx)("button",{onClick:()=>W("os"),className:"px-6 py-3 font-semibold text-sm transition-colors border-b-2 ".concat("os"===R?"border-purple-600 text-purple-600":"border-transparent text-slate-500 hover:text-slate-700"),children:"OS Operations & Logs"}),(0,l.jsx)("button",{onClick:()=>W("files"),className:"px-6 py-3 font-semibold text-sm transition-colors border-b-2 ".concat("files"===R?"border-purple-600 text-purple-600":"border-transparent text-slate-500 hover:text-slate-700"),children:"File Manager"})]}),"os"===R?(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[(0,l.jsxs)("div",{className:"lg:col-span-7 space-y-8",children:[(0,l.jsxs)("section",{children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,l.jsx)("div",{className:"h-8 w-1 bg-purple-600 rounded-full"}),(0,l.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Scenarios"})]}),(0,l.jsxs)("div",{className:"grid gap-6 sm:grid-cols-2",children:[(0,l.jsxs)("div",{className:"glass-card rounded-2xl p-6 relative group transition-all hover:-translate-y-1 hover:shadow-lg",children:[(0,l.jsx)("div",{className:"absolute top-0 right-0 p-4 opacity-5 group-hover:opacity-10 transition-opacity",children:(0,l.jsx)("svg",{className:"w-20 h-20",fill:"currentColor",viewBox:"0 0 20 20",children:(0,l.jsx)("path",{d:"M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"})})}),(0,l.jsx)("h3",{className:"font-bold text-slate-900 mb-2 text-lg",children:"1. Create & Populate"}),(0,l.jsxs)("p",{className:"text-xs text-slate-500 mb-6 leading-relaxed",children:["Initialize a workspace using standard ",(0,l.jsx)("code",{className:"bg-purple-50 px-1 py-0.5 rounded text-purple-600 font-mono",children:"mkdir"})," and ",(0,l.jsx)("code",{className:"bg-purple-50 px-1 py-0.5 rounded text-purple-600 font-mono",children:"write"})," calls."]}),(0,l.jsxs)("div",{className:"space-y-4 relative z-10",children:[(0,l.jsx)("div",{children:(0,l.jsx)("input",{type:"text",value:p,onChange:e=>b(e.target.value),className:"w-full bg-white/50 backdrop-blur-sm rounded-xl border border-slate-200 px-4 py-3 text-sm focus:ring-2 focus:ring-purple-500/20 focus:border-purple-500 outline-none transition-all shadow-sm",placeholder:"Directory Name"})}),(0,l.jsx)("div",{children:(0,l.jsx)("textarea",{value:w,onChange:e=>y(e.target.value),rows:3,className:"w-full bg-white/50 backdrop-blur-sm rounded-xl border border-slate-200 px-4 py-3 text-sm font-mono focus:ring-2 focus:ring-purple-500/20 focus:border-purple-500 outline-none transition-all resize-none shadow-sm",placeholder:"Files..."})}),(0,l.jsx)("button",{onClick:J,disabled:null!==d,className:"w-full rounded-xl bg-slate-900 hover:bg-slate-800 text-white px-4 py-3 text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed shadow-xl shadow-slate-200",children:"create-dir"===d?"Running...":"Run Scenario"})]})]}),(0,l.jsxs)("div",{className:"glass-card rounded-2xl p-6 relative group transition-all hover:-translate-y-1 hover:shadow-lg",children:[(0,l.jsx)("div",{className:"absolute top-0 right-0 p-4 opacity-5 group-hover:opacity-10 transition-opacity",children:(0,l.jsxs)("svg",{className:"w-20 h-20",fill:"currentColor",viewBox:"0 0 20 20",children:[(0,l.jsx)("path",{d:"M4 3a2 2 0 100 4h12a2 2 0 100-4H4z"}),(0,l.jsx)("path",{fillRule:"evenodd",d:"M3 8h14v7a2 2 0 01-2 2H5a2 2 0 01-2-2V8zm5 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z",clipRule:"evenodd"})]})}),(0,l.jsx)("h3",{className:"font-bold text-slate-900 mb-2 text-lg",children:"2. Organize Files"}),(0,l.jsxs)("p",{className:"text-xs text-slate-500 mb-6 leading-relaxed",children:["Automatically sort files by extension using ",(0,l.jsx)("code",{className:"bg-purple-50 px-1 py-0.5 rounded text-purple-600 font-mono",children:"rename"})," syscalls into categorized folders."]}),(0,l.jsxs)("div",{className:"space-y-4 relative z-10",children:[(0,l.jsxs)("div",{className:"pt-2",children:[(0,l.jsx)("label",{className:"block text-[10px] font-bold uppercase tracking-wider text-slate-400 mb-2",children:"Target Directory"}),(0,l.jsx)("input",{value:T,onChange:e=>O(e.target.value),className:"w-full mb-3 bg-white/50 backdrop-blur-sm rounded-xl border border-slate-200 px-4 py-2 text-sm font-mono focus:ring-2 focus:ring-purple-500/20 focus:border-purple-500 outline-none transition-all shadow-sm",placeholder:"Search folders (name or path)…"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("select",{value:N,onChange:e=>k(e.target.value),className:"w-full bg-white/50 backdrop-blur-sm rounded-xl border border-slate-200 pl-4 pr-10 py-3 text-sm font-mono focus:ring-2 focus:ring-purple-500/20 focus:border-purple-500 outline-none transition-all shadow-sm appearance-none cursor-pointer",children:[(0,l.jsx)("option",{value:"",children:"(root)"}),V.map(e=>(0,l.jsx)("option",{value:e.path,children:e.path},e.path))]}),(0,l.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none text-slate-400",children:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),(0,l.jsx)("div",{className:"h-[74px]"})," ",(0,l.jsx)("button",{onClick:K,disabled:null!==d,className:"w-full rounded-xl bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white px-4 py-3 text-sm font-medium transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-xl shadow-purple-200",children:"organize"===d?"Running...":"Run Organize"})]})]})]})]}),h&&(0,l.jsxs)("div",{className:"rounded-xl border border-red-200 bg-red-50/50 backdrop-blur-sm px-4 py-3 text-sm text-red-800 flex items-center gap-2 animate-pulse",children:[(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),h]}),(0,l.jsxs)("section",{children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,l.jsx)("div",{className:"h-8 w-1 bg-slate-800 rounded-full"}),(0,l.jsx)("div",{children:(0,l.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Kernel Log"})}),(0,l.jsx)("span",{className:"ml-auto text-[10px] font-bold text-slate-400 bg-slate-100 px-2 py-1 rounded-full uppercase tracking-wider",children:"System Calls"})]}),(0,l.jsxs)("div",{className:"glass-card rounded-2xl overflow-hidden min-h-[300px]",children:[(0,l.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2 px-4 py-3 border-b border-slate-100 bg-white/30",children:[(0,l.jsxs)("div",{className:"text-xs text-slate-500 font-semibold",children:[A.length," event(s)",E?" (errors only)":""]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("button",{onClick:()=>B(e=>!e),className:"text-xs font-semibold px-3 py-1.5 rounded-lg border transition-colors ".concat(E?"bg-red-50 text-red-700 border-red-200 hover:bg-red-100":"bg-white/60 text-slate-600 border-slate-200 hover:bg-white"),title:"Toggle error-only view",children:E?"Showing errors":"Show errors only"}),(0,l.jsx)("button",{onClick:async()=>{try{await navigator.clipboard.writeText(JSON.stringify(s,null,2))}catch(e){}},className:"text-xs font-semibold px-3 py-1.5 rounded-lg border bg-white/60 text-slate-600 border-slate-200 hover:bg-white transition-colors",title:"Copy log as JSON",children:"Copy JSON"}),(0,l.jsx)("button",{onClick:()=>n([]),className:"text-xs font-semibold px-3 py-1.5 rounded-lg border bg-white/60 text-slate-600 border-slate-200 hover:bg-white transition-colors",title:"Clear log",children:"Clear"})]})]}),0===s.length?(0,l.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-slate-300 py-24",children:[(0,l.jsx)("svg",{className:"w-12 h-12 mb-3 opacity-30",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,l.jsx)("p",{className:"text-sm font-medium",children:"Ready for system calls..."})]}):(0,l.jsx)("div",{className:"divide-y divide-slate-100/50 max-h-[500px] overflow-y-auto scrollbar-thin scrollbar-thumb-slate-200",children:A.map(e=>(0,l.jsx)(v,{o:e,onShowInfo:M},e.id))})]})]})]}),(0,l.jsxs)("div",{className:"lg:col-span-5 space-y-8",children:[(0,l.jsxs)("section",{className:"h-[520px] flex flex-col",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,l.jsx)("div",{className:"h-8 w-1 bg-indigo-500 rounded-full"}),(0,l.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"File System"})]}),(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsx)(i,{tree:F,onDelete:function(e,t,s){if("directory"===t&&s){z({path:e,type:t});return}U(e)},onRefresh:I})})]}),(0,l.jsxs)("section",{children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,l.jsx)("div",{className:"h-8 w-1 bg-emerald-500 rounded-full"}),(0,l.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Result Analysis"})]}),(0,l.jsx)("div",{className:"glass-card rounded-2xl p-6",children:o?"create-dir"===o.type?(0,l.jsxs)("div",{className:"text-center py-6",children:[(0,l.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-emerald-100 text-emerald-600 mb-4 shadow-inner",children:(0,l.jsx)("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,l.jsx)("h4",{className:"font-bold text-lg text-slate-800",children:"Directory Created"}),(0,l.jsxs)("p",{className:"text-sm text-slate-500 mt-2 max-w-xs mx-auto",children:[null===(e=o.result)||void 0===e?void 0:e.created," files generated inside ",(0,l.jsx)("br",{}),(0,l.jsx)("code",{className:"bg-slate-100 px-2 py-0.5 rounded text-xs font-mono mt-1 inline-block text-slate-700",children:null===(t=o.result)||void 0===t?void 0:t.dirPath})]})]}):"organize"===o.type&&o.result?(0,l.jsx)("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(o.result).map(e=>{let[t,s]=e;return(0,l.jsxs)("div",{className:"p-3 rounded-xl border border-slate-100 bg-white/50 hover:bg-white hover:shadow-md transition-all group cursor-default",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-xl grayscale group-hover:grayscale-0 transition-all",children:"Images"===t?"\uD83D\uDDBC️":"Documents"===t?"\uD83D\uDCC4":"Audio"===t?"\uD83C\uDFB5":"Videos"===t?"\uD83C\uDFA5":"\uD83D\uDCE6"}),(0,l.jsx)("span",{className:"font-bold text-slate-700 text-sm group-hover:text-purple-700",children:t})]}),(0,l.jsx)("span",{className:"text-[10px] font-bold px-2 py-0.5 rounded-full border ".concat(s.length>0?"bg-purple-100 text-purple-700 border-purple-200":"bg-slate-100 text-slate-400 border-slate-200"),children:s.length})]}),(0,l.jsx)("div",{className:"h-1.5 w-full bg-slate-100 rounded-full overflow-hidden",children:(0,l.jsx)("div",{className:"h-full bg-gradient-to-r from-purple-500 to-indigo-500 opacity-80 w-full transform origin-left scale-x-0 transition-transform duration-700 ease-out",style:{transform:"scaleX(".concat(s.length>0?1:0,")")}})})]},t)})}):null:(0,l.jsx)("p",{className:"text-slate-400 text-sm italic py-4 text-center",children:"No operation results yet."})})]})]})]}):(0,l.jsx)("div",{className:"h-[calc(100vh-280px)] flex flex-wrap",children:(0,l.jsx)(m,{currentPath:_,onNavigate:e=>P(e),onOperation:e=>{n(t=>[e,...t]),I()}})})]}),(0,l.jsxs)("footer",{className:"mt-16 py-10 text-center text-sm text-slate-500",children:["Made with ❤️ by ",(0,l.jsx)("span",{className:"font-semibold text-slate-700",children:"C Murali Madhav"}),","," ",(0,l.jsx)("span",{className:"font-semibold text-slate-700",children:"Ravi Yadav"})]})]})}},257:function(e,t,s){"use strict";var l,a;e.exports=(null==(l=s.g.process)?void 0:l.env)&&"object"==typeof(null==(a=s.g.process)?void 0:a.env)?s.g.process:s(4227)},4227:function(e){!function(){var t={229:function(e){var t,s,l,a=e.exports={};function r(){throw Error("setTimeout has not been defined")}function n(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(s){try{return t.call(null,e,0)}catch(s){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{s="function"==typeof clearTimeout?clearTimeout:n}catch(e){s=n}}();var i=[],c=!1,d=-1;function x(){c&&l&&(c=!1,l.length?i=l.concat(i):d=-1,i.length&&h())}function h(){if(!c){var e=o(x);c=!0;for(var t=i.length;t;){for(l=i,i=[];++d<t;)l&&l[d].run();d=-1,t=i.length}l=null,c=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===n||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}(e)}}function u(e,t){this.fun=e,this.array=t}function p(){}a.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)t[s-1]=arguments[s];i.push(new u(e,t)),1!==i.length||c||o(h)},u.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=p,a.addListener=p,a.once=p,a.off=p,a.removeListener=p,a.removeAllListeners=p,a.emit=p,a.prependListener=p,a.prependOnceListener=p,a.listeners=function(e){return[]},a.binding=function(e){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw Error("process.chdir is not supported")},a.umask=function(){return 0}}},s={};function l(e){var a=s[e];if(void 0!==a)return a.exports;var r=s[e]={exports:{}},n=!0;try{t[e](r,r.exports,l),n=!1}finally{n&&delete s[e]}return r.exports}l.ab="//";var a=l(229);e.exports=a}()}},function(e){e.O(0,[971,117,744],function(){return e(e.s=5136)}),_N_E=e.O()}]);